<!DOCTYPE html>

<html>
	<head>
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">

		<!--link rel="stylesheet" href="../etudes.css"-->


		
		<style>
			.lil-gui {
				--name-width: 6em;
				--slider-knob-width: 0.5em;
				--widget-padding: 0 0 0 0.5em;
				--number-color: orange;
			}
			
			.lil-gui.root {
				border-bottom-right-radius: 2em;
				margin: 0em;
				padding: 1em;
				left: 0;
				top: 0;
				position: fixed;
			}
			
			.lil-gui input.top{
				border-top-right-radius: 0.65em;
			}
			
			.lil-gui input.bottom, .lil-gui button.bottom{
				border-bottom-right-radius: 0.65em;
			}
			
			.lil-gui .controller.option .widget div {
				width: 9.15em;
			}
			
			.lil-gui em {
				color: Orange;
				font-weight: bold;
				font-style: normal;
			}
			.lil-gui big {
				font-weight: bold;
				text-transform: uppercase;
			}
			
			#primary {
				position: fixed;
				top: 0.5em;
				left: 0.5em;
				display: inline-block;
			}
			
			#secondary {
				position: fixed;
				top: 0.5em;
				right: 0.5em;
				display: inline-block;
			}
			
			right {
				color: gray;
				font-size: 100%;
				float: right;
			}
			
			.lil-gui .controller.string input {
				font-family: Monospace;
			}
			
		</style>
		<script src="libs/lil-gui.umd.js"></script>
	</head>
	
	<body>
		<div id="primary"></div>
		<div id="secondary"></div>
		<!--h1 class="white">Fluid effects<span id="caption"></span><a href="https://boytchev.github.io/etudes/">&larr;</a></h1-->

		<script type="module">

			import * as THREE from './libs/three.module.min.js';
			import { MAX_LEVEL, updatePlatons, exportPlatonAsGLTF, exportPlatonAsJSON, exportPlatonAsImage, exportPlatonAsJS } from './platons.js';
			
			
			var PLATON_TYPES = {
					'<em>T</em>etrahedron': 0,
					'<em>O</em>ctahedron': 1,
					'<em>C</em>ube': 2,
					'<em>D</em>odecahedron': 3,
					'<em>I</em>cosahedron': 4
				}
					
			var EXPORT_TYPES = {
					'JPG &nbsp;<right>image</right>': 1,
					'PNG &nbsp;<right>image</right>': 2,
					'GLB &nbsp;<right>mode</right>': 3,
					'GLTF &nbsp;<right>model</right>': 4,
					'JSON &nbsp;<right>format</right>': 5,
					'HTML &nbsp;<right>page</right>': 6,
					'JS &nbsp;<right>code</right>': 7,
				}
					
			var EXPORT_NAMES = {
					1: 'JPG image',
					2: 'PNG image',
					3: 'GLB model',
					4: 'GLTF model',
					5: 'JSON data',
					6: 'HTML page',
					7: 'JS code',
				}
					
			var mainOptions = {
//					geometry: '',
//					material: '',
					type: 1, /* JPG */
					action: exportPlaton,
				};
			
			var primaryOptions = {
					type: 0,
					level: 3,
					color: 0x09135D,
					gloss: 0,
				};
			
			var secondaryOptions = {
					type: 1,
					level: 2,
					scale: 47,
//					rotation: 0,
					color: 0xffffff,
					gloss: 0,
				};
			
			var tertiaryOptions = {
					type: 1,
					level: 3,
					scale: 36,
//					rotation: 0,
					color: 0xff003f,
					gloss: 0,
				};

			var environmentOptions = {
					background: 0,
					light: 0,
				};
				
			// interactive panel for selecting fluid effects
	
			var gui = new lil.GUI({title:'<big>Platon</big>',container:document.getElementById('primary')});
				gui.add( primaryOptions, 'type', PLATON_TYPES ).name( '<right>type</right>' ).onChange( onChange );
				var a = gui.add( primaryOptions, 'level' ).min( 1 ).max( MAX_LEVEL ).step( 1 ).name( '<right>level</right>' ).onChange( onChange );
				gui.addColor( primaryOptions, 'color' ).name( '<right>color</right>' ).onChange( onChange );
				var b = gui.add( primaryOptions, 'gloss' ).min( -10 ).max( 10 ).step( 1 ).name( '<right>gloss</right>' ).onChange( onChange );

a.$input.classList.add('top');
b.$input.classList.add('bottom');


			var guiSecond = gui.addFolder( '<big>Second platon</big>' );
				guiSecond.add( secondaryOptions, 'type', PLATON_TYPES ).name( '<right>type</right>' ).onChange( onChange );
				a = guiSecond.add( secondaryOptions, 'level' ).min( 1 ).max( MAX_LEVEL ).step( 1 ).name( '<right>level</right>' ).onChange( onChange );
				guiSecond.add( secondaryOptions, 'scale' ).min( 1 ).max( 100 ).step( 1 ).name( '<right>scale</right>' ).onChange( onChange );
				guiSecond.addColor( secondaryOptions, 'color' ).name( '<right>color</right>' ).onChange( onChange );
				b = guiSecond.add( secondaryOptions, 'gloss' ).min( -10 ).max( 10 ).step( 1 ).name( '<right>gloss</right>' ).onChange( onChange );
guiSecond.domElement.style.marginTop = '2em';
a.$input.classList.add('top');				
b.$input.classList.add('bottom');

			var guiThird = gui.addFolder( '<big>Third platon</big>' );
				guiThird.add( tertiaryOptions, 'type', PLATON_TYPES ).name( '<right>Type</right>' ).onChange( onChange );
				a = guiThird.add( tertiaryOptions, 'level' ).min( 1 ).max( MAX_LEVEL ).step( 1 ).name( '<right>Level</right>' ).onChange( onChange );
				guiThird.add( tertiaryOptions, 'scale' ).min( 1 ).max( 100 ).step( 1 ).name( '<right>Scale</right>' ).onChange( onChange );
				guiThird.addColor( tertiaryOptions, 'color' ).name( '<right>color</right>' ).onChange( onChange );
				b = guiThird.add( tertiaryOptions, 'gloss' ).min( -10 ).max( 10 ).step( 1 ).name( '<right>Gloss</right>' ).onChange( onChange );
guiThird.domElement.style.marginTop = '2em';
a.$input.classList.add('top');				
b.$input.classList.add('bottom');

//				gui.add( secondaryOptions, 'rotation' ).min( -12 ).max( 12 ).step( 1 ).name( '<right>rotation</right>' ).onChange( onChange );

//			var guiDecor = gui.addFolder( '<big>Decoration</big>' );
//				guiDecor.addColor( primaryOptions, 'color' ).name( '<right>Primary</right>' ).onChange( onChange );
//				guiDecor.add( primaryOptions, 'gloss' ).min( -10 ).max( 10 ).step( 1 ).name( '<right>Gloss</right>' ).onChange( onChange );
//				guiDecor.addColor( secondaryOptions, 'color' ).name( '<right>Add 1</right>' ).onChange( onChange );
//				guiDecor.add( secondaryOptions, 'gloss' ).min( -10 ).max( 10 ).step( 1 ).name( '<right>Gloss</right>' ).onChange( onChange );
//				guiDecor.addColor( tertiaryOptions, 'color' ).name( '<right>Add 2</right>' ).onChange( onChange );
//				guiDecor.add( tertiaryOptions, 'gloss' ).min( -10 ).max( 10 ).step( 1 ).name( '<right>Gloss</right>' ).onChange( onChange );

//			var guiEnvironment = gui.addFolder( '<big>Environment</big>' ).close( );
//				guiEnvironment.add( environmentOptions, 'background' ).min( -2 ).max( 2 ).step( 1 ).name( 'Background' ).onChange( onChange );
//				guiEnvironment.add( environmentOptions, 'light' ).min( -2 ).max( 2 ).step( 1 ).name( 'Light' ).onChange( onChange );

			var guiExport = gui.addFolder( '<big>Export</big>' );
				guiExport.add( mainOptions, 'type', EXPORT_TYPES ).name( '<right>format</right>' ).onChange( onChange );
				//geoController = gui.add( mainOptions, 'geometry' ).name( 'Code<right>geometry</right>' ).onChange( onChangeCode ),
				//matController = gui.add( mainOptions, 'material' ).name( '<right>material</right>' ).onChange( onChangeCode );
			var	expController = guiExport.add( mainOptions, 'action' ).name( 'Export' );
guiExport.domElement.style.marginTop = '2em';
console.log(expController);
expController.$button.classList.add('bottom');

					


			function onChange( event )
			{
				updatePlatons( primaryOptions, secondaryOptions, tertiaryOptions/*, environmentOptions*/ );
				
				/*
				// TOPOLOGY 
				
				// primary platon
				var geometry = 'TOCDI'[primaryOptions.type];
				if( primaryOptions.level != 1 )
					geometry += primaryOptions.level;
				geometry += '';
				
				// secondary platon
				geometry += 'TOCDI'[secondaryOptions.type];
				if( secondaryOptions.level != 1 )
					geometry += secondaryOptions.level;
				geometry += '+' + secondaryOptions.scale;
				
				mainOptions.geometry = geometry;
				
				// DECORATION 

				var material = primaryOptions.color.toString(16);
				if( primaryOptions.gloss < 0 )
					material += primaryOptions.gloss;
				else if( primaryOptions.gloss > 0 )
					material += '+' + primaryOptions.gloss;
				material += ',';

				material += secondaryOptions.color.toString(16);
				if( secondaryOptions.gloss < 0 )
					material += secondaryOptions.gloss;
				else if( secondaryOptions.gloss > 0 )
					material += '+' + secondaryOptions.gloss;

				mainOptions.material = material;
				*/
				
				expController.name( 'Export as ' + EXPORT_NAMES[mainOptions.type] );
				
				//geoController.updateDisplay( );
				//matController.updateDisplay( );

			}
			

			function exportPlaton( )
			{
				var fileName = '';

				fileName += 'TOCDI'[primaryOptions.type]+primaryOptions.level+'-';
				fileName += 'TOCDI'[secondaryOptions.type]+secondaryOptions.level+secondaryOptions.scale+'-';
				fileName += 'TOCDI'[tertiaryOptions.type]+tertiaryOptions.level+tertiaryOptions.scale;
				
				switch( mainOptions.type )
				{
					case 1 : exportPlatonAsImage( fileName+'.jpg', 'image/jpeg' ); break;
					case 2 : exportPlatonAsImage( fileName+'.png', 'image/png' ); break;
					case 3 : exportPlatonAsGLTF( fileName+'.gltf', true ); break;
					case 4 : exportPlatonAsGLTF( fileName+'.glb', false ); break;
					case 5 : exportPlatonAsJSON( fileName+'.json' ); break;
					case 6 : exportPlatonAsJS( fileName+'.html', true, primaryOptions,  secondaryOptions ); break;
					case 7 : exportPlatonAsJS( fileName+'.js', false, primaryOptions,  secondaryOptions ); break;
				}
			}
			
			
			function onChangeCode( event )
			{
			}
			
			updatePlatons( primaryOptions, secondaryOptions, tertiaryOptions/*environmentOptions*/ );
			onChange( );
		</script>
	</body>
</html>